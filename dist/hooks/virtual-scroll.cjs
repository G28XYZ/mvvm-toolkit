"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("../tslib.es6--9daFdVU.cjs"),p=require("mobx"),g=require("react");let V=(()=>{var s,l,c,i,h,u;let n=[],m,_=[],r=[],d,v=[],f=[],b,H,M;return s=class{get scrollTop(){return t.__classPrivateFieldGet(this,l,"f")}set scrollTop(e){t.__classPrivateFieldSet(this,l,e,"f")}get viewportHeight(){return t.__classPrivateFieldGet(this,c,"f")}set viewportHeight(e){t.__classPrivateFieldSet(this,c,e,"f")}constructor({rowHeight:e,overscan:a=0}){l.set(this,(t.__runInitializers(this,n),t.__runInitializers(this,_,0))),c.set(this,(t.__runInitializers(this,r),t.__runInitializers(this,v,0))),this.overscan=t.__runInitializers(this,f),this.rowHeight=e>0?e:1,this.overscan=Math.max(0,a),p.makeObservable(this)}setScrollTop(e){this.scrollTop=Math.max(0,e)}setViewportHeight(e){this.viewportHeight=Math.max(0,e)}updateMetrics(e,a){this.scrollTop=Math.max(0,e),this.viewportHeight=Math.max(0,a)}setRowHeight(e){this.rowHeight=e>0?e:1}setOverscan(e){this.overscan=Math.max(0,e)}getSlice(e){const a=e.length,w=this.rowHeight>0?this.rowHeight:1,T=Math.max(0,this.scrollTop),I=Math.max(0,this.viewportHeight),S=Math.max(0,this.overscan),y=a*w,x=Math.max(0,Math.floor(T/w)-S),z=Math.min(a,Math.ceil((T+I)/w)+S),k=e.slice(x,z);return{total:a,totalHeight:y,startIndex:x,endIndex:z,visibleItems:k}}},l=new WeakMap,c=new WeakMap,(()=>{const o=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;m=[p.observable],d=[p.observable],b=[(i=p.action).bound.bind(i)],H=[(h=p.action).bound.bind(h)],M=[(u=p.action).bound.bind(u)],t.__esDecorate(s,null,m,{kind:"accessor",name:"scrollTop",static:!1,private:!1,access:{has:e=>"scrollTop"in e,get:e=>e.scrollTop,set:(e,a)=>{e.scrollTop=a}},metadata:o},_,r),t.__esDecorate(s,null,d,{kind:"accessor",name:"viewportHeight",static:!1,private:!1,access:{has:e=>"viewportHeight"in e,get:e=>e.viewportHeight,set:(e,a)=>{e.viewportHeight=a}},metadata:o},v,f),t.__esDecorate(s,null,b,{kind:"method",name:"setScrollTop",static:!1,private:!1,access:{has:e=>"setScrollTop"in e,get:e=>e.setScrollTop},metadata:o},null,n),t.__esDecorate(s,null,H,{kind:"method",name:"setViewportHeight",static:!1,private:!1,access:{has:e=>"setViewportHeight"in e,get:e=>e.setViewportHeight},metadata:o},null,n),t.__esDecorate(s,null,M,{kind:"method",name:"updateMetrics",static:!1,private:!1,access:{has:e=>"updateMetrics"in e,get:e=>e.updateMetrics},metadata:o},null,n),o&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o})})(),s})();const E=({overscan:s=0,rowHeight:l,targetRef:c})=>{const i=g.useMemo(()=>new V({rowHeight:l,overscan:s}),[]);return g.useEffect(()=>{if(typeof window>"u")return;let h=null,u=null,n=!0;const m=r=>{const d=()=>i.setScrollTop(r.scrollTop),v=()=>i.setViewportHeight(r.clientHeight);i.updateMetrics(r.scrollTop,r.clientHeight),r.addEventListener("scroll",d,{passive:!0}),window.addEventListener("resize",v),h=()=>{r.removeEventListener("scroll",d),window.removeEventListener("resize",v)}},_=()=>{if(!n)return;const r=c.current;if(r){m(r);return}u=window.requestAnimationFrame(_)};return _(),()=>{n=!1,u!==null&&window.cancelAnimationFrame(u),h&&h()}},[i,c]),g.useEffect(()=>{i.setRowHeight(l)},[i,l]),g.useEffect(()=>{i.setOverscan(s)},[i,s]),i};exports.VirtualScroll=V;exports.useVirtualScroller=E;
