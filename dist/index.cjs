"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});require("reflect-metadata");const d=require("./tslib.es6-DqNExo46.cjs"),et=require("lodash"),y=require("mobx"),Q=require("immer"),fe=require("mobx-react"),Zt=require("react"),L=(e,i,r)=>Reflect.getOwnMetadata(e,i)||r||{},V=(e,i,r)=>Reflect.defineMetadata(e,i,r);function _e(...e){try{return JSON.stringify(e),!0}catch{return!1}}function ne(e){if(e&&typeof e=="string"){let[i]=e.split(`
`)[2].replace(/at (get)?/,"").match(/.*/g)||[];return i&&(i=i.trim()),i}}const te={},ct=[];let ee=!1;const ye=(e,...i)=>{const r=new Error().stack;if(!ee)console.log("%c TODO","background: #222; color: #bada55",te),ee=!0;else{const s=ne(r);ct.includes(s)===!1&&(ct.push(s),Reflect.set(te,`${ct.length}) ${e}`,{msg:i,get path(){return console.info(i,s),s}}))}function o(...s){}return o},G=(e,i)=>!!e&&(typeof i=="string"||typeof i=="symbol"),q=e=>!!e&&typeof e=="object"&&"kind"in e,ve=e=>({kind:"class",name:e,addInitializer:()=>{},metadata:{}}),J=Symbol("service-key"),ht=new Proxy({},Reflect);function ae(e){const i=(o,s)=>{Object.defineProperty(o,s,{configurable:!0,enumerable:!0,get(){if(Object.prototype.hasOwnProperty.call(this,s))return Reflect.get(this,s);const n=N(e,"instance");if(n)return Object.defineProperty(this,s,{value:n,writable:!0,configurable:!0,enumerable:!0}),n},set(n){const a=N(e,"instance");Object.defineProperty(this,s,{value:a??n,writable:!0,configurable:!0,enumerable:!0})}})};function r(o,s){if(G(o,s)){i(o,s);return}return s.addInitializer(function(){return d.__awaiter(this,void 0,void 0,function*(){const n=N(e,"instance");n&&Object.hasOwn(this,s.name)&&Reflect.set(this,s.name,n)})}),n=>n}return r}function N(e,i){var r;const o=L(J,ht);if(typeof e!="string"){const s=L(J,e);if(s)return i&&i in s?s[i]:s;for(const n in o){const a=o[n];if(a.target===e){e=a.context.name;break}}}if(typeof e=="string")return i?(r=o[e])===null||r===void 0?void 0:r[i]:o[e]}function bt(e,i){const r=(s,n)=>{const a=String(typeof e=="string"&&e||typeof e=="object"&&e?.id||n?.name||s?.name),l=L(J,ht),h=new Proxy({target:s,instance:typeof e=="object"&&Reflect.get(e,"transient")||typeof e=="object"&&Reflect.get(e,"lazy")?s:new s,context:n,options:e},{get(f,v,g){var O,p;if(v==="instance"&&(!((O=f?.options)===null||O===void 0)&&O.transient))return new s;if(v==="instance"&&(!((p=f?.options)===null||p===void 0)&&p.lazy)&&f.instance===s){const T=new s;return Reflect.set(f,v,T,g),T}return Reflect.get(f,v,g)},set(f,v,g,O){return Reflect.set(f,v,g,O)}});l[a]=h,V(J,l,ht),V(J,l[a],s)};function o(s,n){var a,l;const h=s.__legacy_source__,f=q(n)?n:ve((l=(a=h?.name)!==null&&a!==void 0?a:s?.name)!==null&&l!==void 0?l:"");r(s,f),h&&h!==s&&V(J,L(J,s),h)}return et.isFunction(e)?o(e,i):e?(s,n)=>o(s,n):o}const me=(e,i)=>{const{kind:r="class",name:o="",addInitializer:s=()=>{},metadata:n}=i?.ctx||{};return bt(i)(e,{kind:r,name:o,addInitializer:s,metadata:n}),N(e).instance};function dt(e){const i=Object.assign({enumerable:!1,writable:!0},e);return function(r,o){if(G(r,o)){Object.defineProperty(r,o,{configurable:!0,enumerable:i.enumerable,get(){},set(s){Object.defineProperty(this,o,Object.assign({value:s},i))}});return}if(q(o)){const s=o;return s.kind==="field"?function(n){return Object.defineProperty(this,s.name,Object.assign({value:n},i)),n}:(s.addInitializer(function(){const n=Object.getOwnPropertyDescriptor(this,s.name);n&&Object.defineProperty(this,s.name,Object.assign(Object.assign({},n),{enumerable:i.enumerable}))}),r)}}}function R(e,i){return G(e,i)||q(i)?dt()(e,i):dt(e)}function ge(e,i){const r=n=>class extends n{constructor(...a){super(...a),y.makeObservable(this)}},o=(n,a)=>{if(typeof Reflect?.getOwnMetadataKeys=="function")for(const l of Reflect.getOwnMetadataKeys(n)){const h=Reflect.getOwnMetadata(l,n);Reflect.defineMetadata(l,h,a)}};function s(n,a){if(!q(a)){const l=n,h=r(l);return Object.defineProperty(h,"__legacy_source__",{value:l,configurable:!0}),o(l,h),h}a.addInitializer(function(){y.makeObservable(this)})}return e&&!q(i)||e?s(e,i):s}const be=Symbol("field-key"),pe=Symbol("validation-key"),De=Symbol("submit-key"),Ie=Symbol("exclude-key"),Oe=Symbol("prop-from-view-key");class X{isPrototypeObject(i){const r=i?.constructor;return!!(r&&r.prototype===i)}getCacheTarget(i){return!i||typeof i!="object"?null:this.isPrototypeObject(i)?i:Object.getPrototypeOf(i)}computeFromPrototype(i){const r=[],o=new Map,s=new Set;let n=i;for(;n;){const l=Reflect.getOwnMetadata(this.metadataKey,n);if(Array.isArray(l))for(const h of l){const f=h?.name,v=String(f);s.has(v)||(s.add(v),r.push(h),o.set(v,h))}n=Object.getPrototypeOf(n)}return{ownRef:Reflect.getOwnMetadata(this.metadataKey,i),list:r,map:o}}constructor(i={}){this.metadataKey=null,this.cache=new WeakMap,this.name=i?.name,this.callback=i?.callback}isInstance(i={}){return i instanceof X||Object.getOwnPropertyNames(this).some(r=>Object.keys(i).includes(r))}fieldInstance(i,r){const o=r&&typeof r=="object"?Reflect.getOwnMetadata(this.metadataKey,r):void 0;if(Array.isArray(o))return o.find(l=>l.name===i);const s=this.getCacheTarget(r);if(!s)return;const n=Reflect.getOwnMetadata(this.metadataKey,s),a=this.cache.get(s);if(!a||a.ownRef!==n){const l=this.computeFromPrototype(s);return this.cache.set(s,l),l.map.get(String(i))}return a.map.get(String(i))}fields(i){const r=i&&typeof i=="object"?Reflect.getOwnMetadata(this.metadataKey,i):void 0;if(Array.isArray(r)){const l=[],h=new Set;let f=i;for(;f;){const v=Reflect.getOwnMetadata(this.metadataKey,f);if(Array.isArray(v))for(const g of v){const O=g?.name,p=String(O);h.has(p)||(h.add(p),l.push(g))}f=Object.getPrototypeOf(f)}return l}const o=this.getCacheTarget(i);if(!o)return[];const s=Reflect.getOwnMetadata(this.metadataKey,o),n=this.cache.get(o);if(n&&n.ownRef===s)return n.list;const a=this.computeFromPrototype(o);return this.cache.set(o,a),a.list}}class ft extends X{constructor(){super(...arguments),this.metadataKey=pe}}class _t extends X{constructor(){super(...arguments),this.metadataKey=De}}class yt extends X{constructor(){super(...arguments),this.metadataKey=Ie}}class vt extends X{constructor(i={}){super(i),this.factory=null,this.mapping=null,this.collectChanges=!1,this.name=null,this.ctx=null,this.metadataKey=be,this.factory=i.factory,this.mapping=i.mapping,this.name=i.name,this.ctx=i.ctx,this.collectChanges=!!i.collectChanges}}class mt extends X{constructor(i={}){super(i),this.metadataKey=Oe;for(const r in this)i&&r in i&&(this[r]=Reflect.get(i,r))}}function Se(e){const i=(s,n)=>{const a=new mt({name:e,originName:String(n)});a.name=e,a.originName=String(n);const l=L(a.metadataKey,s,new Array);V(a.metadataKey,[...l,a],s)},r=s=>{s.addInitializer(function(){const n=new mt,a=n.fields(this);for(const l in this)a instanceof Array&&s.name===l&&(n.name=e,n.originName=l,n.value=this[l],a.push(n));V(n.metadataKey,a,this)})};function o(s,n){if(G(s,n)){i(s,n);return}if(q(n))return r(n),n.kind==="field"?a=>a:n}return e?((s,n)=>o(s,n)):(s=>s)}function we(e){const i=(s,n)=>{const a=new yt({callback:e,name:String(n)}),l=L(a.metadataKey,s,new Array);V(a.metadataKey,[...l,a],s)},r=s=>{s.addInitializer(function(){const n=new yt({callback:e,name:String(s.name)}),a=L(n.metadataKey,this,new Array);V(n.metadataKey,[...a,n],this)})};function o(s,n){if(G(s,n)){i(s,n);return}if(q(n))return r(n),n.kind==="field"?void 0:n}if(e)return((s,n)=>o(s,n))}const Me=()=>{var e;return(e=globalThis.__REDUX_DEVTOOLS_EXTENSION__)!==null&&e!==void 0?e:null},ke=()=>{var e;return(e=globalThis.__MVVM_DEVTOOLS_APPLYING__)!==null&&e!==void 0?e:0},at=e=>{var i,r;const o=globalThis;o.__MVVM_DEVTOOLS_APPLYING__=((i=o.__MVVM_DEVTOOLS_APPLYING__)!==null&&i!==void 0?i:0)+1;try{return e()}finally{o.__MVVM_DEVTOOLS_APPLYING__=Math.max(0,((r=o.__MVVM_DEVTOOLS_APPLYING__)!==null&&r!==void 0?r:1)-1)}},Ae=()=>ke()>0,ie=e=>({data:e.service.dumpData,historyIndex:e.service.historyIndex}),re=(e,i={})=>{const r=Me();if(!r)return()=>{};const o=r.connect({name:i.name,instanceId:i.instanceId});let s=!1;try{o.init(ie(e))}catch{}const n=y.reaction(()=>ie(e),l=>{var h;if(!(s||Ae()))try{o.send({type:(h=i.actionType)!==null&&h!==void 0?h:"model:update"},l)}catch{}}),a=o.subscribe(l=>{var h;if(l.type!=="DISPATCH")return;const f=(h=l.payload)===null||h===void 0?void 0:h.type;if(f==="RESET"){s=!0,at(()=>{try{e.service.toInit()}finally{s=!1}});return}if(f==="COMMIT"){s=!0,at(()=>{try{e.service.commit()}finally{s=!1}});return}if(f==="ROLLBACK"){s=!0,at(()=>{try{e.service.toInit()}finally{s=!1}});return}if(f==="JUMP_TO_ACTION"||f==="JUMP_TO_STATE"){if(!l.state)return;try{const v=JSON.parse(l.state),g=v.historyIndex,O=e.service.history,p=Array.isArray(O)&&O.length>0,T=typeof g=="number"&&(g===-1&&p||g>=0&&p&&g<O.length);s=!0,at(()=>{var z;try{if(T){e.service.goToHistory(g);return}const P=(z=v.data)!==null&&z!==void 0?z:v;y.runInAction(()=>{e.service.loadData(P)})}finally{s=!1}})}catch{}}});return()=>{n(),typeof a=="function"&&a(),typeof o.unsubscribe=="function"&&o.unsubscribe(),typeof o.disconnect=="function"&&o.disconnect()}};Q.enablePatches();const Te=new _t,Y=new vt,Ee=new ft,Pe=new yt;let oe=(()=>{var e,i,r,o,s,n,a,l,h,f;let v=[],g,O=[],p=[],T,z=[],P=[],K,B=[],x=[],M,u=[],w=[],k,j=[],E=[],C,H=[],U=[],$,Z=[],it=[],st,nt=[],pt=[],Dt,It=[],Ot=[],St,wt=[],Mt=[],kt,At=[],Tt=[],Et,Pt=[],zt=[],xt,jt=[],Ft=[],Vt,Ct=[],Rt=[],Lt,Kt,Ht,qt,Gt,Bt,Yt,Nt,Ut,$t,Wt,Qt;return e=class{get initData(){return d.__classPrivateFieldGet(this,i,"f")}set initData(t){d.__classPrivateFieldSet(this,i,t,"f")}get committedData(){return d.__classPrivateFieldGet(this,r,"f")}set committedData(t){d.__classPrivateFieldSet(this,r,t,"f")}get modified_(){return d.__classPrivateFieldGet(this,o,"f")}set modified_(t){d.__classPrivateFieldSet(this,o,t,"f")}get changes(){return d.__classPrivateFieldGet(this,s,"f")}set changes(t){d.__classPrivateFieldSet(this,s,t,"f")}get inverseChanges(){return d.__classPrivateFieldGet(this,n,"f")}set inverseChanges(t){d.__classPrivateFieldSet(this,n,t,"f")}get history(){return d.__classPrivateFieldGet(this,a,"f")}set history(t){d.__classPrivateFieldSet(this,a,t,"f")}get historyIndex(){return d.__classPrivateFieldGet(this,l,"f")}set historyIndex(t){d.__classPrivateFieldSet(this,l,t,"f")}constructor(t={},c){this[h]=(d.__runInitializers(this,v),d.__runInitializers(this,O,!0)),i.set(this,(d.__runInitializers(this,p),d.__runInitializers(this,z,null))),r.set(this,(d.__runInitializers(this,P),d.__runInitializers(this,B,{}))),o.set(this,(d.__runInitializers(this,x),d.__runInitializers(this,u,{}))),this.draft=(d.__runInitializers(this,w),d.__runInitializers(this,j,null)),s.set(this,(d.__runInitializers(this,E),d.__runInitializers(this,H,[]))),n.set(this,(d.__runInitializers(this,U),d.__runInitializers(this,Z,[]))),a.set(this,(d.__runInitializers(this,it),d.__runInitializers(this,nt,[]))),l.set(this,(d.__runInitializers(this,pt),d.__runInitializers(this,It,-1))),this.initializedFields=(d.__runInitializers(this,Ot),d.__runInitializers(this,wt,void 0)),this.legacyInitDone=(d.__runInitializers(this,Mt),d.__runInitializers(this,At,!1)),this.rawInitData=(d.__runInitializers(this,Tt),d.__runInitializers(this,Pt,null)),this.options=(d.__runInitializers(this,zt),d.__runInitializers(this,jt,void 0)),this.historyMuted=(d.__runInitializers(this,Ft),d.__runInitializers(this,Ct,!1)),this.serviceApi=(d.__runInitializers(this,Rt),{loadData:_=>this.loadData(_),reject:()=>this.reject(),commit:()=>this.commit(),commitField:_=>this.commitField(_),toInit:()=>this.toInit(),undo:()=>this.undo(),redo:()=>this.redo(),goToHistory:_=>this.goToHistory(_)}),this.options=c,this[Q.immerable]=!0,this.init(t),this.autoAttachDevtools(),this.initLegacyFields()}initValidation(t){if(t)Reflect.get(this.validation,t);else for(const c in this.validation)this.validation[c]}init(t={}){this.cloneForInit(t),this.createDraft(t),this.defineData(this.initData)}initField(t,c){const _=Y.fieldInstance(t,this);if(_){t in this.initData||Reflect.set(this.initData,t,Reflect.get(this,t));const m=_?.factory?_.factory(this.initData,this):Reflect.get(this.initData,_.name);this.defineFieldValue(t,m,_),c?.skipValidation||this.initValidation(t),this.getInitializedFields().add(String(t))}}getInitializedFields(){return this.initializedFields||(this.initializedFields=new Set),this.initializedFields}initLegacyFields(){var t;if(this.legacyInitDone)return;const c=Y.fields(this);if(!c.some(D=>Object.prototype.hasOwnProperty.call(this,D.name)))return;this.legacyInitDone=!0;const m=this.getInitializedFields(),b=(t=this.rawInitData)!==null&&t!==void 0?t:this.initData;if(b&&b!==this.initData)try{this.initData=b}catch{this.initData=Object.assign({},b)}for(const D of c){const I=String(D.name);if(b&&I in b){const F=Y.fieldInstance(I,this);if(!F)continue;if(!m.has(I)){const W=b,tt=F.factory?F.factory(W,this):Reflect.get(W,F.name);this.defineFieldValue(I,tt),Reflect.set(this,I,tt),m.add(I)}continue}m.has(I)||this.initField(I,{skipValidation:!0})}}createDraft(t){const c={};for(const _ in t)Y.fieldInstance(_,this)&&Reflect.set(c,_,t[_]);this.draft=Q.createDraft(c)}autoAttachDevtools(){var t,c,_,m,b,D,I,A,F,W,tt,ot;const lt=globalThis;if(!lt.__MVVM_DEVTOOLS_AUTO__||((c=(t=this.options)===null||t===void 0?void 0:t.devtools)===null||c===void 0?void 0:c.enabled)===!1)return;const Jt=(I=(b=(m=(_=this.options)===null||_===void 0?void 0:_.devtools)===null||m===void 0?void 0:m.name)!==null&&b!==void 0?b:(D=this.constructor)===null||D===void 0?void 0:D.name)!==null&&I!==void 0?I:"Model",Xt=((A=lt.__MVVM_DEVTOOLS_SEQ__)!==null&&A!==void 0?A:0)+1;lt.__MVVM_DEVTOOLS_SEQ__=Xt;const ue=(tt=(W=(F=this.options)===null||F===void 0?void 0:F.devtools)===null||W===void 0?void 0:W.instanceId)!==null&&tt!==void 0?tt:`${Jt}#${Xt}`;((ot=globalThis.queueMicrotask)!==null&&ot!==void 0?ot:(he=>Promise.resolve().then(he)))(()=>re(this,{name:Jt,instanceId:ue}))}withHistoryMuted(t){this.historyMuted=!0;try{t()}finally{this.historyMuted=!1}}syncChangesFromHistory(){const t=this.historyIndex>=0?this.history.slice(0,this.historyIndex+1):[];this.changes=t.flatMap(c=>c.patches),this.inverseChanges=t.flatMap(c=>c.inversePatches)}applyHistoryPatches(t){if(!t.length)return;Q.applyPatches(this.draft,t);const c=new Set(t.map(_=>_.field).filter(Boolean));c.size!==0&&this.withHistoryMuted(()=>{var _;for(const m of c){const b=(_=Reflect.get(this.draft,m))!==null&&_!==void 0?_:Reflect.get(this.initData,m);let D=b;try{D=b}catch{D=b}Reflect.set(this,m,D),this.defineFieldValue(m,Reflect.get(this,m))}})}produceDraft(t,c,_){if(this.historyMuted)return;let m,b=[];t&&(m=t.split(".")[0],m&&!Y.fieldInstance(m,this).collectChanges)||(Q.produce(this.draft,D=>{if(t){let I=D;const A=t.split(".");if(A.length>1)for(let F=0;F<A.length&&!(!(F==A.length-1)&&!et.isObject(I));F++)et.isObject(I)&&(I=I[A[F]]);else _=t;I&&(I[_]=c)}},(D,I)=>{m&&(D=D.map(A=>Object.assign(Object.assign({},A),{field:m})),I=I.map(A=>Object.assign(Object.assign({},A),{field:m}))),b=D,!(!D.length&&!I.length)&&(this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1),this.syncChangesFromHistory()),this.changes.push(...D),this.inverseChanges.push(...I),this.history.push({patches:D,inversePatches:I}),this.historyIndex=this.history.length-1)}),b.length&&Q.applyPatches(this.draft,b))}createObservable(t,c,_,m=_){return t=y.isObservable(t)?t:y.observable.box(t),new Proxy(t,{get:(b,D,I)=>{const A=Reflect.get(b,D,I);return A&&typeof A=="object"&&!(A instanceof e)&&!y.isObservable(t)?this.createObservable(A,String(D),c,`${m}.${String(D)}`):A},set:(b,D,I,A)=>{const F=Reflect.set(b,D,I,A);return t=I,this.produceDraft(m,t,String(D)),this.checkChange(_,Reflect.get(this,_)),F}})}defineFieldValue(t,c,_){return!_&&(_=Y.fieldInstance(t,this)),c&&typeof c=="object"&&(c=this.createObservable(c,t,t)),c=y.observable.box(c),Reflect.defineProperty(this,_.name,{get:()=>c.get(),set:m=>{y.runInAction(()=>c.set(m)),this.produceDraft(_.name,c.get()),this.checkChange(_.name,c.get())},enumerable:!0,configurable:!0}),c}cloneForInit(t){if(t)try{this.initData=Object.assign({},t)}catch{}else this.rawInitData=null}checkChange(t,c){const _=c,m=Reflect.get(this.committedData,t)||Reflect.get(this.initData,t),b=t&&t in this.initData&&!et.isEqual(m,_);return y.runInAction(()=>{b&&Reflect.set(this.modified_,t,m||m);for(const D in this.modified_)t===D&&t in this.modified_&&et.isEqual(m,_)&&delete this.modified_[D]}),b}defineData(t){for(const c in this){if(!Object.prototype.hasOwnProperty.call(this,c))continue;Y.fieldInstance(c,this)&&(Reflect.set(this,c,Reflect.get(t,c)),this.initField(c))}}get dirty(){return!et.isEmpty(this.modified_)}commit(){for(const t of Y.fields(this))this.commitField(t.name);this.modified_={}}commitField(t){for(const c in this)c in this.modified_&&Reflect.set(this.committedData,c,this[c]);delete this.modified_[t],this.modified_=Object.assign({},this.modified_)}reject(){for(const t in this)t in this.modified_&&(this[t]=Reflect.get(this.modified_,t),this.commitField(t),this.defineFieldValue(t,this[t]));this.commit()}toInit(){return this.withHistoryMuted(()=>{for(const t in this)if(t in this.initData){const c=Reflect.get(this.initData,t);this[t]=c,this.initField(t)}this.init(this.initData)}),this}undo(){if(this.historyIndex<0)return;const t=this.history[this.historyIndex];this.historyIndex-=1,this.applyHistoryPatches(t.inversePatches),this.syncChangesFromHistory()}redo(){if(this.historyIndex>=this.history.length-1)return;const t=this.historyIndex+1,c=this.history[t];this.historyIndex=t,this.applyHistoryPatches(c.patches),this.syncChangesFromHistory()}goToHistory(t){if(!(t<-1||t>=this.history.length)&&t!==this.historyIndex){for(;this.historyIndex<t;){const c=this.historyIndex+1,_=this.history[c];this.historyIndex=c,this.applyHistoryPatches(_.patches)}for(;this.historyIndex>t;){const c=this.history[this.historyIndex];this.historyIndex-=1,this.applyHistoryPatches(c.inversePatches)}this.syncChangesFromHistory()}}loadData(t){return this.withHistoryMuted(()=>{this.init(t),this.defineData(this.initData)}),this}get dumpData(){this.initLegacyFields();const t=Object.create({}),c=m=>{const b=Te.fieldInstance(m,this);return b?.callback?b.callback(Reflect.get(this,m),this):Reflect.get(this,m)},_=m=>{const b=Pe.fieldInstance(m,this);if(b)switch(typeof b.callback){case"boolean":return!!b.callback;case"function":return b.callback(Reflect.get(this,m),this)}return!1};Y.fields(this).forEach(m=>{var b;if(m.name in this)return!((b=this.options)===null||b===void 0)&&b.byFields&&!this.options.byFields.includes(m.name)||_(m.name)?void 0:Reflect.set(t,m.name,c(m.name))});try{return t}catch{return t&&Object.assign({},t)}}get validation(){this.initLegacyFields();const t={};for(const c in this){const _=Ee.fieldInstance(c,this);_&&Reflect.set(t,c,_.callback(this[c],this)||"")}return t}get validAndDirty(){return this.dirty&&Object.values(this.validation).filter(Boolean).length===0}get service(){return Object.assign({dirty:this.dirty,dumpData:this.dumpData,validation:this.validation,changes:this.changes,inverseChanges:this.inverseChanges,history:this.history,historyIndex:this.historyIndex},this.serviceApi)}},i=new WeakMap,r=new WeakMap,o=new WeakMap,s=new WeakMap,n=new WeakMap,a=new WeakMap,l=new WeakMap,g=[R],h=d.__propKey(Q.immerable),(()=>{const S=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;T=[y.observable,R],K=[y.observable,R],M=[y.observable,R],k=[R],C=[y.observable,R],$=[y.observable,R],st=[y.observable,R],Dt=[y.observable,R],St=[R],kt=[R],Et=[R],xt=[R],Vt=[R],Lt=[y.action],Kt=[y.computed],Ht=[y.action],qt=[y.action],Gt=[y.action],Bt=[y.action],Yt=[y.action],Nt=[y.action],Ut=[y.action],$t=[y.computed],Wt=[y.computed],Qt=[(f=y.computed).struct.bind(f)],d.__esDecorate(e,null,T,{kind:"accessor",name:"initData",static:!1,private:!1,access:{has:t=>"initData"in t,get:t=>t.initData,set:(t,c)=>{t.initData=c}},metadata:S},z,P),d.__esDecorate(e,null,K,{kind:"accessor",name:"committedData",static:!1,private:!1,access:{has:t=>"committedData"in t,get:t=>t.committedData,set:(t,c)=>{t.committedData=c}},metadata:S},B,x),d.__esDecorate(e,null,M,{kind:"accessor",name:"modified_",static:!1,private:!1,access:{has:t=>"modified_"in t,get:t=>t.modified_,set:(t,c)=>{t.modified_=c}},metadata:S},u,w),d.__esDecorate(e,null,C,{kind:"accessor",name:"changes",static:!1,private:!1,access:{has:t=>"changes"in t,get:t=>t.changes,set:(t,c)=>{t.changes=c}},metadata:S},H,U),d.__esDecorate(e,null,$,{kind:"accessor",name:"inverseChanges",static:!1,private:!1,access:{has:t=>"inverseChanges"in t,get:t=>t.inverseChanges,set:(t,c)=>{t.inverseChanges=c}},metadata:S},Z,it),d.__esDecorate(e,null,st,{kind:"accessor",name:"history",static:!1,private:!1,access:{has:t=>"history"in t,get:t=>t.history,set:(t,c)=>{t.history=c}},metadata:S},nt,pt),d.__esDecorate(e,null,Dt,{kind:"accessor",name:"historyIndex",static:!1,private:!1,access:{has:t=>"historyIndex"in t,get:t=>t.historyIndex,set:(t,c)=>{t.historyIndex=c}},metadata:S},It,Ot),d.__esDecorate(e,null,Lt,{kind:"method",name:"produceDraft",static:!1,private:!1,access:{has:t=>"produceDraft"in t,get:t=>t.produceDraft},metadata:S},null,v),d.__esDecorate(e,null,Kt,{kind:"getter",name:"dirty",static:!1,private:!1,access:{has:t=>"dirty"in t,get:t=>t.dirty},metadata:S},null,v),d.__esDecorate(e,null,Ht,{kind:"method",name:"commit",static:!1,private:!1,access:{has:t=>"commit"in t,get:t=>t.commit},metadata:S},null,v),d.__esDecorate(e,null,qt,{kind:"method",name:"commitField",static:!1,private:!1,access:{has:t=>"commitField"in t,get:t=>t.commitField},metadata:S},null,v),d.__esDecorate(e,null,Gt,{kind:"method",name:"reject",static:!1,private:!1,access:{has:t=>"reject"in t,get:t=>t.reject},metadata:S},null,v),d.__esDecorate(e,null,Bt,{kind:"method",name:"toInit",static:!1,private:!1,access:{has:t=>"toInit"in t,get:t=>t.toInit},metadata:S},null,v),d.__esDecorate(e,null,Yt,{kind:"method",name:"undo",static:!1,private:!1,access:{has:t=>"undo"in t,get:t=>t.undo},metadata:S},null,v),d.__esDecorate(e,null,Nt,{kind:"method",name:"redo",static:!1,private:!1,access:{has:t=>"redo"in t,get:t=>t.redo},metadata:S},null,v),d.__esDecorate(e,null,Ut,{kind:"method",name:"goToHistory",static:!1,private:!1,access:{has:t=>"goToHistory"in t,get:t=>t.goToHistory},metadata:S},null,v),d.__esDecorate(e,null,$t,{kind:"getter",name:"validation",static:!1,private:!1,access:{has:t=>"validation"in t,get:t=>t.validation},metadata:S},null,v),d.__esDecorate(e,null,Wt,{kind:"getter",name:"validAndDirty",static:!1,private:!1,access:{has:t=>"validAndDirty"in t,get:t=>t.validAndDirty},metadata:S},null,v),d.__esDecorate(e,null,Qt,{kind:"getter",name:"service",static:!1,private:!1,access:{has:t=>"service"in t,get:t=>t.service},metadata:S},null,v),d.__esDecorate(null,null,g,{kind:"field",name:h,static:!1,private:!1,access:{has:t=>h in t,get:t=>t[h],set:(t,c)=>{t[h]=c}},metadata:S},O,p),d.__esDecorate(null,null,k,{kind:"field",name:"draft",static:!1,private:!1,access:{has:t=>"draft"in t,get:t=>t.draft,set:(t,c)=>{t.draft=c}},metadata:S},j,E),d.__esDecorate(null,null,St,{kind:"field",name:"initializedFields",static:!1,private:!1,access:{has:t=>"initializedFields"in t,get:t=>t.initializedFields,set:(t,c)=>{t.initializedFields=c}},metadata:S},wt,Mt),d.__esDecorate(null,null,kt,{kind:"field",name:"legacyInitDone",static:!1,private:!1,access:{has:t=>"legacyInitDone"in t,get:t=>t.legacyInitDone,set:(t,c)=>{t.legacyInitDone=c}},metadata:S},At,Tt),d.__esDecorate(null,null,Et,{kind:"field",name:"rawInitData",static:!1,private:!1,access:{has:t=>"rawInitData"in t,get:t=>t.rawInitData,set:(t,c)=>{t.rawInitData=c}},metadata:S},Pt,zt),d.__esDecorate(null,null,xt,{kind:"field",name:"options",static:!1,private:!1,access:{has:t=>"options"in t,get:t=>t.options,set:(t,c)=>{t.options=c}},metadata:S},jt,Ft),d.__esDecorate(null,null,Vt,{kind:"field",name:"historyMuted",static:!1,private:!1,access:{has:t=>"historyMuted"in t,get:t=>t.historyMuted,set:(t,c)=>{t.historyMuted=c}},metadata:S},Ct,Rt),S&&Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:S})})(),e})();const ze=()=>{var e;const i=globalThis;return!!((e=i.__MVVM_DEVTOOLS_HISTORY__)!==null&&e!==void 0?e:i.__MVVM_DEVTOOLS_AUTO__)},xe=e=>ze()?!e||typeof e!="object"?{collectChanges:!0}:"collectChanges"in e?e:Object.assign(Object.assign({},e),{collectChanges:!0}):e;function je(e,i){const r=xe(G(e,i)?void 0:e),o=(a,l)=>{const h=new vt(Object.assign(Object.assign({},r),{name:String(l),ctx:null})),f=L(h.metadataKey,a,new Array);V(h.metadataKey,[...f,h],a),Object.getOwnPropertyDescriptor(a,l)||Object.defineProperty(a,l,{configurable:!0,enumerable:!0,get(){if(Object.prototype.hasOwnProperty.call(this,l))return Reflect.get(this,l);if(this.initData&&l in this.initData&&typeof this.initField=="function")return this.initField.call(this,String(l),{skipValidation:!0}),Reflect.get(this,l)},set(g){if(this.initData&&!(l in this.initData)&&Reflect.set(this.initData,l,g),typeof this.initField=="function"){this.initField.call(this,String(l),{skipValidation:!0});return}Object.defineProperty(this,l,{value:g,writable:!0,configurable:!0,enumerable:!0})}})},s=a=>{a.addInitializer(function(){if(this instanceof oe&&typeof this.initField=="function"){const l=new vt(Object.assign(Object.assign({},r),{name:String(a.name),ctx:a})),h=L(l.metadataKey,this,new Array);V(l.metadataKey,[...h,l],this),this.initField.call(this,String(a.name))}})};function n(a,l){if(G(a,l)){o(a,l);return}if(q(l))return s(l),l.kind==="field"?h=>h:l}return G(e,i)?n(e,i):r&&!q(i)?(a,l)=>n(a,l):q(i)?n(void 0,i):(a,l)=>n(a,l)}function Fe(e){const i=(s,n)=>{const a=new _t({callback:e,name:String(n)}),l=L(a.metadataKey,s,new Array);V(a.metadataKey,[...l,a],s)},r=s=>{const n=new _t({callback:e,name:String(s.name)});s.addInitializer(function(){const a=L(n.metadataKey,this,new Array);V(n.metadataKey,[...a,n],this)})};function o(s,n){if(G(s,n)){i(s,n);return}if(q(n))return r(n),n.kind==="field"?a=>a:n}return e?((s,n)=>o(s,n)):(s=>s)}function Ve(e){const i=(s,n)=>{const a=new ft({callback:e,name:String(n)}),l=L(a.metadataKey,s,new Array);V(a.metadataKey,[...l,a],s)},r=s=>{const n=new ft({callback:e,name:String(s.name)});s.addInitializer(function(){const a=L(n.metadataKey,this,new Array);V(n.metadataKey,[...a,n],this)})};function o(s,n){if(G(s,n)){i(s,n);return}if(q(n))return r(n),n.kind==="field"?a=>a:n}return e?((s,n)=>o(s,n)):(s=>s)}const le=Symbol("store-key"),Ce=()=>{var e;return(e=globalThis.__REDUX_DEVTOOLS_EXTENSION__)!==null&&e!==void 0?e:null},Re=()=>{var e;return(e=globalThis.__MVVM_DEVTOOLS_APPLYING__)!==null&&e!==void 0?e:0},Le=e=>{var i,r;const o=globalThis;o.__MVVM_DEVTOOLS_APPLYING__=((i=o.__MVVM_DEVTOOLS_APPLYING__)!==null&&i!==void 0?i:0)+1;try{return e()}finally{o.__MVVM_DEVTOOLS_APPLYING__=Math.max(0,((r=o.__MVVM_DEVTOOLS_APPLYING__)!==null&&r!==void 0?r:1)-1)}},Ke=()=>Re()>0,gt=e=>({items:e.items.map(i=>{var r,o;return{name:(o=(r=i.constructor)===null||r===void 0?void 0:r.name)!==null&&o!==void 0?o:"Model",data:i.service.dumpData,historyIndex:i.service.historyIndex}})}),He=e=>!!(e&&typeof e=="object"&&Array.isArray(e.items)),qe=e=>{if(!e)return null;try{const i=JSON.parse(e);return He(i)?i:null}catch{return null}},ce=(e,i={})=>{var r,o;const s=Ce();if(!s)return()=>{};const n=s.connect({name:i.name,instanceId:i.instanceId});let a=!1,l=(o=(r=e.items[0])===null||r===void 0?void 0:r.constructor)!==null&&o!==void 0?o:null;try{n.init(gt(e))}catch{}const h=y.reaction(()=>gt(e),g=>{var O;if(a||Ke())return;const p=(O=e.items[0])===null||O===void 0?void 0:O.constructor;p&&(l=p);try{n.send({type:"store:update"},g)}catch{}}),f=g=>(a=!0,Le(()=>{try{return g()}finally{a=!1}})),v=n.subscribe(g=>{var O;if(g.type!=="DISPATCH")return;const p=(O=g.payload)===null||O===void 0?void 0:O.type;if(p==="RESET"||p==="ROLLBACK"){f(()=>e.reset());return}if(p==="JUMP_TO_ACTION"||p==="JUMP_TO_STATE"){const T=qe(g.state);if(!T)return;f(()=>{var z,P,K;if(T.items.length===e.items.length&&e.items.every(w=>{var k,j;return typeof((k=w?.service)===null||k===void 0?void 0:k.goToHistory)=="function"||typeof((j=w?.service)===null||j===void 0?void 0:j.loadData)=="function"})){y.runInAction(()=>{T.items.forEach((w,k)=>{var j;const E=(j=e.items[k])===null||j===void 0?void 0:j.service,C=w.historyIndex,H=E?.history;if(Array.isArray(H)&&H.length>0&&typeof C=="number"&&typeof E?.goToHistory=="function"&&(C===-1&&H.length>0||C<H.length)){E.goToHistory(C);return}typeof E?.loadData=="function"&&E.loadData(w.data)})});return}const x=(P=(z=e.items[0])===null||z===void 0?void 0:z.constructor)!==null&&P!==void 0?P:l,M=T.items.map(w=>w.data);if(x){e.applyLoaded(M,{model:x,cash:!1}),l=x;return}e.applyLoaded(M,{cash:!1});const u=(K=e.items[0])===null||K===void 0?void 0:K.constructor;u&&(l=u)})}});return()=>{h(),typeof v=="function"&&v(),typeof n.unsubscribe=="function"&&n.unsubscribe(),typeof n.disconnect=="function"&&n.disconnect()}};let Ge=(()=>{var e,i,r;let o=[],s,n=[],a=[],l,h=[],f=[],v,g,O,p,T,z,P,K,B,x;return e=class{get items(){return d.__classPrivateFieldGet(this,i,"f")}set items(u){d.__classPrivateFieldSet(this,i,u,"f")}get _cash(){return d.__classPrivateFieldGet(this,r,"f")}set _cash(u){d.__classPrivateFieldSet(this,r,u,"f")}constructor(){i.set(this,(d.__runInitializers(this,o),d.__runInitializers(this,n,[]))),r.set(this,(d.__runInitializers(this,a),d.__runInitializers(this,h,[]))),d.__runInitializers(this,f),y.makeObservable(this),this.autoAttachDevtools()}add(u){this.items=this.items.concat(u)}addMany(u){u?.length&&(this.items=this.items.concat(u))}remove(u){this.items=this.items.filter(w=>w!==u)}find(u){return this.items.find(u)}filter(u){return this.items.filter(u)}findBy(u,w){return this.items.find(k=>k?.[u]===w)}clear(){this.items=[]}get size(){return this.items.length}get snapshot(){return gt(this)}get cash(){return this._cash}reset(){this.clear()}applyLoaded(u,w={}){const{model:k,mode:j="replace",cash:E=!0}=w;if(E&&this.setCash(u),j==="append"){const C=k?u.map(H=>new k(H)):u;this.addMany(C);return}this.items=k?u.map(C=>new k(C)):u}setCash(u){this._cash=u??[]}autoAttachDevtools(){var u,w,k,j,E,C,H,U;const $=globalThis;if(!$.__MVVM_DEVTOOLS_AUTO__)return;const Z=L(le,this.constructor,{})||{};if(((u=Z.devtools)===null||u===void 0?void 0:u.enabled)===!1)return;const it=(E=(k=(w=Z.devtools)===null||w===void 0?void 0:w.name)!==null&&k!==void 0?k:(j=this.constructor)===null||j===void 0?void 0:j.name)!==null&&E!==void 0?E:"Store",st=((C=$.__MVVM_DEVTOOLS_STORE_SEQ__)!==null&&C!==void 0?C:0)+1;$.__MVVM_DEVTOOLS_STORE_SEQ__=st;const nt=(U=(H=Z.devtools)===null||H===void 0?void 0:H.instanceId)!==null&&U!==void 0?U:`${it}#${st}`;ce(this,{name:it,instanceId:nt})}},i=new WeakMap,r=new WeakMap,(()=>{const M=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;s=[y.observable],l=[y.observable],v=[y.action],g=[y.action],O=[y.action],p=[y.action],T=[y.computed],z=[y.computed],P=[y.computed],K=[y.action],B=[y.action],x=[y.action],d.__esDecorate(e,null,s,{kind:"accessor",name:"items",static:!1,private:!1,access:{has:u=>"items"in u,get:u=>u.items,set:(u,w)=>{u.items=w}},metadata:M},n,a),d.__esDecorate(e,null,l,{kind:"accessor",name:"_cash",static:!1,private:!1,access:{has:u=>"_cash"in u,get:u=>u._cash,set:(u,w)=>{u._cash=w}},metadata:M},h,f),d.__esDecorate(e,null,v,{kind:"method",name:"add",static:!1,private:!1,access:{has:u=>"add"in u,get:u=>u.add},metadata:M},null,o),d.__esDecorate(e,null,g,{kind:"method",name:"addMany",static:!1,private:!1,access:{has:u=>"addMany"in u,get:u=>u.addMany},metadata:M},null,o),d.__esDecorate(e,null,O,{kind:"method",name:"remove",static:!1,private:!1,access:{has:u=>"remove"in u,get:u=>u.remove},metadata:M},null,o),d.__esDecorate(e,null,p,{kind:"method",name:"clear",static:!1,private:!1,access:{has:u=>"clear"in u,get:u=>u.clear},metadata:M},null,o),d.__esDecorate(e,null,T,{kind:"getter",name:"size",static:!1,private:!1,access:{has:u=>"size"in u,get:u=>u.size},metadata:M},null,o),d.__esDecorate(e,null,z,{kind:"getter",name:"snapshot",static:!1,private:!1,access:{has:u=>"snapshot"in u,get:u=>u.snapshot},metadata:M},null,o),d.__esDecorate(e,null,P,{kind:"getter",name:"cash",static:!1,private:!1,access:{has:u=>"cash"in u,get:u=>u.cash},metadata:M},null,o),d.__esDecorate(e,null,K,{kind:"method",name:"reset",static:!1,private:!1,access:{has:u=>"reset"in u,get:u=>u.reset},metadata:M},null,o),d.__esDecorate(e,null,B,{kind:"method",name:"applyLoaded",static:!1,private:!1,access:{has:u=>"applyLoaded"in u,get:u=>u.applyLoaded},metadata:M},null,o),d.__esDecorate(e,null,x,{kind:"method",name:"setCash",static:!1,private:!1,access:{has:u=>"setCash"in u,get:u=>u.setCash},metadata:M},null,o),M&&Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:M})})(),e})();function Be(e){return N(e,"instance")}function Ye(e){return((i,r)=>ae(e)(i,r))}function Ne(e,i){const r=(o,s)=>{var n;const a=typeof e=="string"?{id:e}:typeof e=="object"?e:{id:(n=s?.name)!==null&&n!==void 0?n:o?.name};V(le,a,o),bt(a)(o,s)};return typeof e=="function"?r(e,i):(o,s)=>r(o,s)}class Ue{}const ut=new mt;function $e(e,i){return fe.observer((r={})=>{const{resolved:o,instance:s}=Zt.useMemo(()=>{const a=N(e)||(typeof e!="string"?{instance:new e}:void 0),l=a?.instance;return{resolved:a,instance:l}},[e]);if(Zt.useEffect(()=>{if(s)return typeof s.onInit=="function"&&s.onInit(),()=>{typeof s.onDispose=="function"&&s.onDispose()}},[s]),o){const n=ut.fields(s),a=n.length>0?n:ut.fields(Object.getPrototypeOf(s));for(const l in r)if(a instanceof Array){const h=a.find(f=>f.name===l);h&&Reflect.set(s,h.originName,Reflect.get(r,l))}return V(ut.metadataKey,a,s),i(Object.assign({viewModel:s},r))}return i(Object.assign({},r))})}const se={load:"load",failure:"failure",ready:"ready",canceled:"canceled",disposed:"disposed"},We={load:"load",failure:"failure",ready:"ready",canceled:"canceled",disposed:"disposed"},rt=()=>{};class Qe{constructor(i,r){var o,s,n,a,l,h,f;this.isExecuting=!1,this.activeCount=0,this.isCanceled=!1,this.isDisposed=!1,this.error=null,this.controllers=new Set,this.queue=[],this.runningPromise=null,this.queueTail=Promise.resolve(),this.cancelToken=0,this.fn=i,this.opt=Object.assign({concurrency:(o=r?.concurrency)!==null&&o!==void 0?o:"ignore",trackError:(s=r?.trackError)!==null&&s!==void 0?s:!0,resetErrorOnExecute:(n=r?.resetErrorOnExecute)!==null&&n!==void 0?n:!0,swallowError:(a=r?.swallowError)!==null&&a!==void 0?a:!0,abortable:(l=r?.abortable)!==null&&l!==void 0?l:!1},r),this.states=Object.assign(Object.assign({},se),(h=r?.states)!==null&&h!==void 0?h:{}),this.stateKeys=Object.assign(Object.assign({},We),(f=r?.stateKeys)!==null&&f!==void 0?f:{}),y.makeAutoObservable(this,{fn:!1,opt:!1,states:!1,stateKeys:!1,resolveState:!1,getScope:!1,controllers:!1,queue:!1,runningPromise:!1,queueTail:!1,cancelToken:!1},{autoBind:!0})}get canExecute(){return this.isDisposed||!(this.opt.canExecute?this.opt.canExecute(this.getScope()):!0)?!1:this.opt.concurrency==="ignore"?!this.isExecuting:!0}resolveState(i){var r,o;const s=(r=this.stateKeys[i])!==null&&r!==void 0?r:i;return(o=this.states[s])!==null&&o!==void 0?o:se[i]}getScope(){return{state:this.state,states:this.states,isExecuting:this.isExecuting,activeCount:this.activeCount,isCanceled:this.isCanceled,isDisposed:this.isDisposed,error:this.error}}get state(){return this.isDisposed?this.resolveState("disposed"):this.isExecuting?this.resolveState("load"):this.error?this.resolveState("failure"):this.isCanceled?this.resolveState("canceled"):this.resolveState("ready")}resetError(){this.error=null}cancel(){var i,r;this.cancelToken+=1,this.isCanceled=!0,(r=(i=this.opt).onCancel)===null||r===void 0||r.call(i),this.opt.cancelQueued&&this.clearQueue();for(const o of this.controllers)o.abort()}dispose(){this.isDisposed||(this.isDisposed=!0,this.clearQueue(),this.cancel())}clearQueue(){if(this.queue.length===0)return;const i=this.queue.splice(0,this.queue.length);for(const r of i)r.canceled=!0,r.settled||(r.settled=!0,r.resolve(void 0))}execute(...i){var r;if(this.isDisposed)return Promise.resolve(void 0);if(!this.canExecute)return(r=this.runningPromise)!==null&&r!==void 0?r:Promise.resolve(void 0);const o=n=>{this.runningPromise=n;const a=()=>{this.runningPromise===n&&(this.runningPromise=null)};return n.then(a,a),n},s=()=>d.__awaiter(this,void 0,void 0,function*(){var n,a,l,h,f,v,g,O;if(this.isDisposed)return;const p=this.opt.abortable?new AbortController:null;p&&this.controllers.add(p),y.runInAction(()=>{this.activeCount+=1,this.isExecuting=this.activeCount>0,this.isCanceled=!1,this.opt.trackError&&this.opt.resetErrorOnExecute&&(this.error=null)});const T=this.cancelToken;let z=!1,P=!1,K=null,B=null;try{(a=(n=this.opt).onStart)===null||a===void 0||a.call(n,...i);const x=this.opt.abortable?p.signal:void 0;B=this.fn(...i,x);const M=yield B;return P=this.cancelToken!==T,P?void 0:((h=(l=this.opt).onSuccess)===null||h===void 0||h.call(l,M,...i),z=!0,M)}catch(x){if(this.opt.abortable&&p?.signal.aborted){y.runInAction(()=>{this.isCanceled=!0}),P=!0,K=null;return}if(K=x,P=this.cancelToken!==T,this.opt.trackError&&y.runInAction(()=>{this.error=x}),(v=(f=this.opt).onError)===null||v===void 0||v.call(f,x),!this.opt.swallowError)throw x;return}finally{y.runInAction(()=>{this.activeCount=Math.max(0,this.activeCount-1),this.isExecuting=this.activeCount>0}),p&&this.controllers.delete(p),!P&&this.cancelToken!==T&&(P=!0),(O=(g=this.opt).onFinally)===null||O===void 0||O.call(g,{ok:z,canceled:P,error:K},...i)}});switch(this.opt.concurrency){case"parallel":return o(s());case"restart":return this.cancel(),o(s());case"queue":{const n=this.opt.queueLimit;if(typeof n=="number"&&n>0&&this.queue.length>=n)return Promise.resolve(void 0);const a={promise:Promise.resolve(void 0),resolve:rt,reject:rt,canceled:!1,settled:!1},l=this.activeCount===0&&this.queue.length===0;a.promise=new Promise((v,g)=>{a.resolve=v,a.reject=g}),this.queue.push(a);const h=()=>d.__awaiter(this,void 0,void 0,function*(){if(a.settled)return;if(a.canceled||this.isDisposed){a.settled=!0,a.resolve(void 0);return}const v=this.queue.indexOf(a);v>=0&&this.queue.splice(v,1);try{const g=yield s();a.settled||(a.settled=!0,a.resolve(g))}catch(g){a.settled||(a.settled=!0,a.reject(g))}}),f=l?h():this.queueTail.then(h,h);return this.queueTail=f.then(rt,rt),o(a.promise)}default:return this.isExecuting&&this.runningPromise?this.runningPromise:o(s())}}}function de(e,i){return new Qe(e,i)}function Je(e,i){const r=y.flow(e),o=new Set,s=i?.onCancel;return de((...a)=>{const l=r(...a);o.add(l);const h=()=>{o.delete(l)};return l.then(h,h),new Promise((f,v)=>{l.then(f,g=>{if(y.isFlowCancellationError(g)){f(void 0);return}v(g)})})},Object.assign(Object.assign({},i),{onCancel:()=>{var a;for(const l of o)(a=l.cancel)===null||a===void 0||a.call(l);s?.()}}))}function Xe(e){return function(...i){return y.runInAction(()=>e.apply(this,i))}}exports.GetService=N;exports.GetStore=Be;exports.Inject=ae;exports.InjectStore=Ye;exports.MakeObservable=ge;exports.Model=oe;exports.PropFromView=Se;exports.Service=bt;exports.SetService=me;exports.Store=Ne;exports.StoreBase=Ge;exports.TODO=ye;exports.ViewModel=Ue;exports.asyncCommand=de;exports.attachModelDevtools=re;exports.attachStoreDevtools=ce;exports.commandAction=Xe;exports.defineMetadata=V;exports.define_prop=R;exports.exclude=we;exports.field=je;exports.flowCommand=Je;exports.getExecutingFunctionNameByStack=ne;exports.getOwnMetadata=L;exports.isSerializable=_e;exports.submit=Fe;exports.validation=Ve;exports.view=$e;
//# sourceMappingURL=index.cjs.map
