{"version":3,"file":"mvvm-di.js","sources":["../../src/vite-plugins/mvvm-di.ts"],"sourcesContent":[null],"names":["SERVICE_DECORATOR","STORE_DECORATOR","MVVM_MODULE","mvvmServiceDiPlugin","config","srcRoot","diPath","scanAndUpdateAll","files","collectSourceFiles","file","processFile","ensureDiFile","exists","containers","collectContainerFiles","content","fs","imports","serviceInterfaces","storeInterfaces","containerPath","servicesName","inferInterfaceName","storesName","inferStoresInterfaceName","importPath","toImportPath","path","filePath","entries","extractEntries","entry","ensureEntryInContainer","kind","ts","source","resolveContext","buildResolveContext","serviceIdentifiers","storeIdentifiers","statement","importClause","element","imported","_b","_a","local","results","node","className","decorators","_c","decorator","expr","decoratorName","isService","isStore","firstArg","key","resolvedKey","resolveServiceIdFromDecoratorArg","arg","context","idProp","prop","resolveStringFromExpression","resolveState","localConsts","collectLocalConstInitializers","importedConsts","collectImportedConstRefs","locals","declaration","moduleName","namedBindings","resolvedPath","resolveImportSource","importName","localName","fromFilePath","basePath","candidates","candidate","value","span","resolved","left","right","resolveStringFromIdentifier","name","localInit","importRef","resolveImportedStringConstant","ref","cacheKey","resolveExportedStringConstant","exportName","readSourceFile","collectExportedNameMap","initializer","exported","mod","inferScriptKind","target","findContainerTarget","containerExisted","entryKey","formatServiceKey","interfaceName","diInterfaceName","ensureDiIncludesContainer","existing","updated","updateContainerContent","absolute","currentDir","segments","containerDir","importStatement","escapeRegExp","insertImport","interfaceBlock","findInterfaceBlock","block","entryLineRe","lines","cleanedLines","hasEntry","changed","line","match","keyText","typeName","entryLine","insertIndex","newBody","initialContent","insertDiImport","normalizeDiDeclaration","ensureDiInterfaceDeclaration","ensureDiExtends","i","startMatch","startIndex","endIndex","body","indentMatch","indent","re","moduleMatch","moduleStart","moduleEnd","findMatchingBrace","insertion","depth","char","extendsList","start","end","nameSegment","toPascalCase","part","fromDir","withoutExt","dir","fullPath","ctx"],"mappings":"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"}