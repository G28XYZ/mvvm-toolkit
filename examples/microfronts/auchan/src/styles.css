:root{
  --card-w: 400px;
  --paper:#ffffff;
  --line:#e7ecef;
  --text:#2f3a44;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:#dfe6ea;
}

.page{
  min-height:100%;
  display:grid;
  place-items:center;
  padding:24px;
}

/* stack effect */
.paperStack{
  width:var(--card-w);
  position:relative;
  filter: drop-shadow(0 10px 14px rgba(0,0,0,.18));
}

.paperStack::before,
.paperStack::after{
  content:"";
  position:absolute;
  left:0; right:0;
  top:0; bottom:0;
  background:var(--paper);
  border-radius:3px;
  border:1px solid rgba(0,0,0,.08);
  z-index:-2;
}

.paperStack::before{
  transform: translate(6px, 10px);
  opacity:.85;
}

.paperStack::after{
  transform: translate(12px, 20px);
  opacity:.65;
  z-index:-3;
}

.paper{
  background:var(--paper);
  border-radius:3px;
  border:1px solid rgba(0,0,0,.10);
  overflow:hidden;

  /* ✅ фиксируем высоту и раскладываем блоки */
  height: min(640px, 80vh);
  display:flex;
  flex-direction:column;
}

/* header */
/* ====== header: liquid glass ====== */
.todoHeader{
  position:relative;
  height:70px;
  display:flex;
  align-items:center;
  justify-content:center;

  /* glass */
  background: rgba(255,255,255,.14);
  backdrop-filter: blur(14px) saturate(180%);
  -webkit-backdrop-filter: blur(14px) saturate(180%);

  /* subtle edge */
  border-bottom: 1px solid rgba(255,255,255,.28);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.55),
    inset 0 -1px 0 rgba(0,0,0,.10);

  overflow:hidden;
}

.todoHeader::before{
  content:"";
  position:absolute;
  inset:-40%;
  /* liquid highlights / переливы */
  background:
    radial-gradient(120px 90px at 20% 35%, rgba(255,255,255,.70), rgba(255,255,255,0) 60%),
    radial-gradient(180px 120px at 70% 20%, rgba(140,190,255,.45), rgba(140,190,255,0) 62%),
    radial-gradient(220px 160px at 55% 90%, rgba(120,255,210,.22), rgba(120,255,210,0) 65%),
    linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.06));
  transform: rotate(-8deg);
  pointer-events:none;
}

.todoHeader::after{
  content:"";
  position:absolute;
  inset:0;
  /* glossy sheen */
  background:
    linear-gradient(180deg,
      rgba(255,255,255,.40) 0%,
      rgba(255,255,255,.10) 32%,
      rgba(255,255,255,0) 60%
    );
  opacity:.55;
  pointer-events:none;
}

.todoHeader::before{
  animation: liquidShift 6s ease-in-out infinite;
}

@keyframes liquidShift{
  0%   { transform: rotate(-8deg) translate3d(-6px,-2px,0); opacity:.90; }
  50%  { transform: rotate(-6deg) translate3d( 8px, 2px,0); opacity:1; }
  100% { transform: rotate(-8deg) translate3d(-6px,-2px,0); opacity:.90; }
}

.todoHeader__right{
  grid-column: 3;
  justify-self: end;

  position: absolute;
  z-index: 2;
  right: -10px;
}

/* body & notebook line */
.todoBody{
  position:relative;

  /* ✅ занимает всё доступное между header и input */
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  scrollbar-gutter: stable;
}

.todoBody::-webkit-scrollbar{
  width: 10px;
}
.todoBody::-webkit-scrollbar-thumb{
  background: rgba(0,0,0,.15);
  border-radius: 999px;
  border: 3px solid rgba(255,255,255,.7);
}

.todoBody::before{
  content:"";
  position:absolute;
  top:0;
  bottom:0;
  left:56px;
  width:2px;
  background: rgba(210, 86, 86, .55);
}

/* list */
.todoList{
  list-style:none;
  padding:0;
  margin:0;
}

.todoItem{
  display:grid;
  grid-template-columns: 56px 1fr 64px;
  align-items:center;
  min-height:64px;
  border-bottom:1px solid var(--line);
}

.todoItem__left{
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  background: #f4f7f9;
}

.check{
  width:30px;
  height:30px;
  border-radius:4px;
  border:1px solid rgba(0,0,0,.18);
  background: linear-gradient(#f6f8fa, #dfe6ea);
  color: transparent;
  font-size:18px;
  font-weight:900;
  line-height:30px;
  text-align:center;
  cursor:pointer;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.8);
}

.check--done{
  background: linear-gradient(#cfe9c9, #9fd08f);
  color: rgba(0,0,0,.45);
}

.todoItem__content{
  padding:0 16px;
  display:flex;
  justify-content:center;
}

.todoItem__text{
  font-size:18px;
  font-weight:700;
  letter-spacing:.5px;
  color: var(--text);
}

.todoItem.isDone .todoItem__text{
  color: rgba(80, 92, 104, .35);
  text-decoration: line-through;
  text-decoration-thickness: 2px;
}

.todoItem__remove{
  border:none;
  background:transparent;
  color: rgba(0,0,0,.15);
  font-size:22px;
  cursor:pointer;
  height:100%;
}
.todoItem__remove:hover{
  color: rgba(0,0,0,.35);
}

/* input */
.todoInputWrap{
  padding:14px 16px;
  border-top:1px solid var(--line);
  background: #f7fafc;
}

.todoInput{
  width:100%;
  border:1px solid rgba(0,0,0,.18);
  background: #ffffff;
  border-radius:3px;
  padding:12px 12px;
  font-size:18px;
  font-style: italic;
  outline:none;
  box-shadow: inset 0 1px 3px rgba(0,0,0,.08);
}

.todoInput::placeholder{
  color: rgba(0,0,0,.35);
}

.todoInputRow{
  display:flex;
  gap:10px;
  align-items:center;
}

.todoAddBtn{
  height:46px;
  padding:0 14px;
  border-radius:4px;
  border:1px solid rgba(0,0,0,.18);
  background: linear-gradient(#f6f8fa, #dfe6ea);
  font-weight:700;
  cursor:pointer;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.8);
}

.todoAddBtn:hover{
  filter: brightness(0.98);
}

.todoAddBtn:active{
  transform: translateY(1px);
}

.todoItem__actions{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  height:100%;
}

.todoIconBtn{
  width:26px;
  height:26px;
  border:none;
  background:transparent;
  color: rgba(0,0,0,.22);
  font-size:18px;
  cursor:pointer;
  border-radius:4px;
}

.todoIconBtn:hover{
  background: rgba(0,0,0,.05);
  color: rgba(0,0,0,.40);
}

.todoTextBtn{
  width:100%;
  border:none;
  background:transparent;
  padding:0;
  cursor:text;
  display:flex;
  justify-content:center;
}

.todoEditInput{
  width:100%;
  border:1px solid rgba(0,0,0,.18);
  border-radius:4px;
  padding:10px 12px;
  font-size:18px;
  font-weight:700;
  letter-spacing:.5px;
  outline:none;
  box-shadow: inset 0 1px 3px rgba(0,0,0,.08);
  background:#fff;
}

.todoEditWrap{
  width:100%;
  display:flex;
  flex-direction:column;
  gap:6px;
  position: relative;
}

.todoEditInput.hasError{
  border-color: rgba(210, 86, 86, .75);
}

.todoEditError{
  position: absolute;
  font-size:12px;
  font-weight:600;
  color: rgba(210, 86, 86, .95);
  bottom: -5px;
  background: white;
}

/* чуть больше места под инпут */
.todoItem.isEditing .todoItem__content{
  padding: 0 10px;
  justify-content: stretch;
}

/* spinner */
.spinner{
  position: relative;
  min-width: var(--spinner-size, 28px);
  min-height: var(--spinner-size, 28px);
  background: rgba(84, 84, 84, .2);
}

.spinner::after{
  --spinner-radius: calc((var(--spinner-size, 28px) - var(--spinner-dot, 4px)) / 2);

  content:"";
  position:absolute;
  top:50%;
  left:50%;
  width: var(--spinner-dot, 4px);
  height: var(--spinner-dot, 4px);
  border-radius:50%;
  background: transparent;
  transform: translate(-50%, -50%);
  pointer-events:none;

  box-shadow:
    0 calc(var(--spinner-radius) * -1) 0 1.5px rgba(47, 58, 68, 0.95),
    calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
    var(--spinner-radius) 0 0 -0.75px rgba(47, 58, 68, 0.25),
    calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
    0 var(--spinner-radius) 0 -0.75px rgba(47, 58, 68, 0.25),
    calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
    calc(var(--spinner-radius) * -1) 0 0 0 rgba(47, 58, 68, 0.5),
    calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * -0.7071) 0 0.75px rgba(47, 58, 68, 0.7);

  animation: spinner-pulse 1s linear infinite;
}

@keyframes spinner-pulse{
  0%,
  100%{
    box-shadow:
      0 calc(var(--spinner-radius) * -1) 0 1.5px rgba(47, 58, 68, 0.95),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      var(--spinner-radius) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      0 var(--spinner-radius) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -1) 0 0 0 rgba(47, 58, 68, 0.5),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * -0.7071) 0 0.75px rgba(47, 58, 68, 0.7);
  }
  12.5%{
    box-shadow:
      0 calc(var(--spinner-radius) * -1) 0 0.75px rgba(47, 58, 68, 0.7),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * -0.7071) 0 1.5px rgba(47, 58, 68, 0.95),
      var(--spinner-radius) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      0 var(--spinner-radius) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -1) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * -0.7071) 0 0 rgba(47, 58, 68, 0.5);
  }
  25%{
    box-shadow:
      0 calc(var(--spinner-radius) * -1) 0 0 rgba(47, 58, 68, 0.5),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * -0.7071) 0 0.75px rgba(47, 58, 68, 0.7),
      var(--spinner-radius) 0 0 1.5px rgba(47, 58, 68, 0.95),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      0 var(--spinner-radius) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -1) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25);
  }
  37.5%{
    box-shadow:
      0 calc(var(--spinner-radius) * -1) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * -0.7071) 0 0 rgba(47, 58, 68, 0.5),
      var(--spinner-radius) 0 0 0.75px rgba(47, 58, 68, 0.7),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * 0.7071) 0 1.5px rgba(47, 58, 68, 0.95),
      0 var(--spinner-radius) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -1) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25);
  }
  50%{
    box-shadow:
      0 calc(var(--spinner-radius) * -1) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      var(--spinner-radius) 0 0 0 rgba(47, 58, 68, 0.5),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * 0.7071) 0 0.75px rgba(47, 58, 68, 0.7),
      0 var(--spinner-radius) 0 1.5px rgba(47, 58, 68, 0.95),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -1) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25);
  }
  62.5%{
    box-shadow:
      0 calc(var(--spinner-radius) * -1) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      var(--spinner-radius) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * 0.7071) 0 0 rgba(47, 58, 68, 0.5),
      0 var(--spinner-radius) 0 0.75px rgba(47, 58, 68, 0.7),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * 0.7071) 0 1.5px rgba(47, 58, 68, 0.95),
      calc(var(--spinner-radius) * -1) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25);
  }
  75%{
    box-shadow:
      0 calc(var(--spinner-radius) * -1) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      var(--spinner-radius) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      0 var(--spinner-radius) 0 0 rgba(47, 58, 68, 0.5),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * 0.7071) 0 0.75px rgba(47, 58, 68, 0.7),
      calc(var(--spinner-radius) * -1) 0 0 1.5px rgba(47, 58, 68, 0.95),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25);
  }
  87.5%{
    box-shadow:
      0 calc(var(--spinner-radius) * -1) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * -0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      var(--spinner-radius) 0 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * 0.7071) calc(var(--spinner-radius) * 0.7071) 0 -0.75px rgba(47, 58, 68, 0.25),
      0 var(--spinner-radius) 0 -0.75px rgba(47, 58, 68, 0.25),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * 0.7071) 0 0 rgba(47, 58, 68, 0.5),
      calc(var(--spinner-radius) * -1) 0 0 0.75px rgba(47, 58, 68, 0.7),
      calc(var(--spinner-radius) * -0.7071) calc(var(--spinner-radius) * -0.7071) 0 1.5px rgba(47, 58, 68, 0.95);
  }
}


/* filter */
.todoFilters{
  display:flex;
  gap:10px;
  margin-top:10px;
}

.todoFilterBtn{
  flex:1;
  height:40px;
  border-radius:6px;
  border:1px solid rgba(0,0,0,.16);
  background: rgba(255,255,255,.7);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  cursor:pointer;
  font-weight:700;
  color: rgba(0,0,0,.55);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.7);
}

.todoFilterBtn:hover{
  filter: brightness(0.99);
}

.todoFilterBtn.isActive{
  background: linear-gradient(#d7f0ff, #c1dcff);
  color: rgba(0,0,0,.65);
  border-color: rgba(0,0,0,.18);
}

/* liquid glass switch */

/* ===== liquid “drop” language switch ===== */
.langSwitch{
  --gap: 10px;
  --pad: 6px;
  --h: 38px;

  position: relative;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--gap);

  transform: scale(0.8);

  padding: var(--pad);
  height: var(--h);
  width: 140px;

  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.35);
  background: rgba(255,255,255,.16);

  backdrop-filter: blur(10px) saturate(170%);
  -webkit-backdrop-filter: blur(10px) saturate(170%);

  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.55),
    0 10px 18px rgba(0,0,0,.10);

  overflow: hidden;
}

/* “капля” */
.langBlob{
  position:absolute;
  top: var(--pad);
  bottom: var(--pad);

  width: calc((100% - (var(--pad) * 2) - var(--gap)) / 2);

  /* смещение капли: 0 -> EN, 1 -> RU */
  left: calc(
    var(--pad) + (var(--pos) * ( (100% - (var(--pad) * 2) - var(--gap)) / 2 + var(--gap) ))
  );

  border-radius: 999px;
  background: rgba(255,255,255,.38);

  /* “стеклянность” капли */
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.70),
    inset 0 -1px 0 rgba(0,0,0,.10),
    0 8px 16px rgba(0,0,0,.10);

  /* движение */
  transition: left 320ms cubic-bezier(.2,.9,.2,1);

  /* “жидкое” сжатие/растяжение */
  animation: blobSquash 420ms cubic-bezier(.2,.9,.2,1);
}

/* кнопки поверх капли */
.langBtn{
  position: relative;
  z-index: 2;

  border: none;
  background: transparent;

  border-radius: 999px;
  height: calc(var(--h) - (var(--pad) * 2));

  font-weight: 900;
  letter-spacing: .2px;

  color: rgba(35,40,45,.60);
  cursor: pointer;

  /* эффект “одна больше, другая меньше” */
  transform: scale(.96);
  transition:
    transform 220ms cubic-bezier(.2,.9,.2,1),
    color 220ms cubic-bezier(.2,.9,.2,1);
}

.langBtn.isActive{
  color: rgba(35,40,45,.92);
  transform: scale(1.06);
}

/* небольшая отдача при клике */
.langBtn:active{
  transform: scale(1.02);
}

@keyframes blobSquash{
  0%   { transform: scaleX(1.00) scaleY(1.00); }
  30%  { transform: scaleX(1.12) scaleY(.92); }
  65%  { transform: scaleX(.96)  scaleY(1.06); }
  100% { transform: scaleX(1.00) scaleY(1.00); }
}
